<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HdR Watch Zines</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üìö</text></svg>">    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            color: #dddddd;
            background: #222222;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: #222222;
            border-radius: 12px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
            overflow: hidden;
        }
        
        header {
            background: #111111;
            color: #dddddd;
            padding: 40px 30px;
            text-align: center;
            position: relative;
        }
        
        .lang-switcher {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            gap: 10px;
        }
        
        .lang-btn {
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            color: #dddddd;
            padding: 8px 15px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: background 0.2s;
        }
        
        .lang-btn:hover {
            background: rgba(255,255,255,0.2);
        }
        
        .lang-btn.active {
            background: #0F82AF;
            color: #dddddd;
        }
        
        header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 700;
        }
        
        header p {
            font-size: 1.1em;
            opacity: 0.95;
        }
        
        .content {
            padding: 40px 30px;
        }
        
        .intro {
            text-align: center;
            margin-bottom: 40px;
            color: #dddddd;
        }
        
        .zines-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-top: 30px;
        }
        
        @media (max-width: 768px) {
            .zines-grid {
                grid-template-columns: 1fr;
            }
            
            header h1 {
                font-size: 1.8em;
            }
            
            .lang-switcher {
                position: static;
                justify-content: center;
                margin-bottom: 20px;
            }
        }
        
        .zine-card {
            background: #333333;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        .zine-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.5);
        }
        
        .zine-card-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
        }
        
        .zine-card-content {
            padding: 20px;
        }
        
        .zine-card h3 {
            margin-bottom: 10px;
            color: #dddddd;
            font-size: 1.2em;
        }
        
        .zine-card p {
            color: #bbbbbb;
            margin-bottom: 15px;
            font-size: 0.9em;
            line-height: 1.5;
        }
        
        .download-btn {
            display: inline-block;
            padding: 8px 16px;
            background: #0F82AF;
            color: white;
            text-decoration: none;
            border-radius: 6px;
            font-weight: 600;
            font-size: 0.85em;
            transition: background 0.2s;
            margin-right: 8px;
        }
        
        .download-btn:hover {
            background: #0d6a8f;
        }
        
        footer {
            background: #111111;
            color: #dddddd;
            padding: 30px;
            text-align: center;
        }
        
        footer p {
            margin: 5px 0;
            opacity: 0.9;
        }
        
        footer a {
            color: #099dd7;
            text-decoration: none;
        }
        
        footer a:hover {
            text-decoration: underline;
        }
        
        .hidden {
            display: none;
        }
        
        .unfold-btn {
            display: inline-block;
            padding: 8px 16px;
            background: #444444;
            color: white;
            text-decoration: none;
            border-radius: 6px;
            font-weight: 600;
            font-size: 0.85em;
            transition: background 0.2s;
            margin-top: 8px;
            cursor: pointer;
            border: none;
        }
        
        .unfold-btn:hover {
            background: #555555;
        }
        
        .page-gallery {
            display: none;
            flex-direction: column;
            align-items: center;
            gap: 15px;
            padding: 20px;
            background: #1a1a1a;
            border-radius: 6px;
            position: fixed;
            top: 25%;
            left: 35%;
            transform: translate(-35%, -25%);
            z-index: 1000;
            max-width: 100%;
            max-height: 100vh;
            overflow-y: auto;
            box-shadow: 0 10px 50px rgba(0,0,0,0.8);
        }
        
        .page-gallery.active {
            display: flex;
        }
        
        .page-gallery-close {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #0F82AF;
            color: white;
            border: none;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            font-size: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            transition: background 0.2s;
            z-index: 10;
        }
        
        .page-gallery-close:hover {
            background: #0d6a8f;
        }
        
        .page-gallery img {
            height: 600px;
            width: auto;
            border-radius: 4px;
            border: 1px solid #444444;
            display: none;
        }
        
        .page-gallery img.active-page {
            display: block;
        }
        
        .page-nav {
            display: flex;
            gap: 15px;
            align-items: center;
        }
        
        .page-nav-btn {
            background: #0F82AF;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: background 0.2s;
        }
        
        .page-nav-btn:hover {
            background: #0d6a8f;
        }
        
        .page-counter {
            font-weight: 600;
            min-width: 50px;
            text-align: center;
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            font-size: 1.2em;
            color: #999;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="lang-switcher">
                <button class="lang-btn active" onclick="setLanguage('es')">ES</button>
                <button class="lang-btn" onclick="setLanguage('de')">DE</button>
                <button class="lang-btn" onclick="setLanguage('en')">EN</button>
            </div>
            <h1>‚åö HdR Watch Zines</h1>
            <p id="header-subtitle">Folletos de instrucciones imprimibles para aficionados a la relojer√≠a</p>
            <div style="margin-top: 10px; font-size: 0.85em; opacity: 0.8;">
                üìö Fuentes: 
                <a href="https://www.hablemosderelojes.com/t//268418" target="_blank" style="color: #0F82AF; text-decoration: none; margin: 0 8px;">√çndice alfab√©tico (@JOSERRA100)</a> ¬∑ 
                <a href="https://www.hablemosderelojes.com/t/228190/71" target="_blank" style="color: #0F82AF; text-decoration: none; margin: 0 8px;">Cronolog√≠a (@soymicmic)</a>
            </div>
            <div style="margin-top: 15px;">
                <a href="timeline2.html" style="display: inline-block; padding: 10px 20px; background: #0F82AF; color: white; text-decoration: none; border-radius: 6px; font-weight: 600; font-size: 0.9em; transition: opacity 0.2s;">üìÖ Ver Timeline de Proyectos</a>
            </div>
        </header>
        
        <div class="content">
            <div class="intro">
                <p id="intro-text-1">Descarga zines listos para imprimir de tus relojes favoritos de la comunidad "Hablemos de Relojes".</p>
                <p id="intro-text-2">Cada zine est√° dise√±ado para plegarse en un folleto compacto que encaja perfectamente en tu estuche de reloj.</p>
            </div>
            
            <div class="zines-grid" id="zines-grid">
                <div class="loading">Cargando zines...</div>
            </div>
        </div>
        
        <footer>
            <p id="footer-about"><strong>Sobre este proyecto</strong></p>
            <p id="footer-text-1">Los zines se generan con <a href="https://github.com/typst/typst">Typst</a> usando la plantilla <em>zen-zine</em>.</p>
            <p id="footer-text-2">Proyecto comunitario de <a href="https://www.hablemosderelojes.com">Hablemos de Relojes</a>.</p>
            <p><a href="https://github.com/jlcases/HdR_zines" id="footer-github">GitHub</a> | <a href="https://coda.io/d/_dI_CRGnK7b9" id="footer-docs">Documentaci√≥n</a></p>
        </footer>
    </div>

    <script>
        let ZINES_DATA = [];
        let currentLanguage = 'es';

        // Fetch zines data from JSON
        async function loadZinesData() {
            try {
                const response = await fetch('zines_data.json');
                ZINES_DATA = await response.json();
                renderAllZines();
                
                // Set language after loading data
                const savedLang = localStorage.getItem('preferredLanguage') || 'es';
                setLanguage(savedLang);
            } catch (error) {
                console.error('Error loading zines data:', error);
                document.getElementById('zines-grid').innerHTML = '<p class="loading">Error al cargar los datos de los zines.</p>';
            }
        }

        function renderZineCard(zine) {
            const descriptionKey = `description_${currentLanguage}`;
            const description = zine[descriptionKey] || zine.description_es || '';
            
            return `
                <div class="zine-card">
                    <img src="${zine.sourceFolder}/${zine.id}_front.jpeg" alt="${zine.title}" class="zine-card-image">
                    <div class="zine-card-content">
                        <h3>${zine.title} ${zine.emoji}</h3>
                        <p class="zine-description" data-id="${zine.id}">${description}</p>
                        <div>
                            <a href="${zine.pdfFolder}/${zine.id} zine.pdf" class="download-btn" download>
                                <span class="download-btn-text">üì• Descargar</span>
                            </a>
                            <button class="unfold-btn" onclick="togglePages('${zine.id}-pages')">
                                <span class="unfold-btn-text">üìñ Ver p√°ginas</span>
                            </button>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderGallery(zine) {
            let imagesHTML = '';
            for (let i = 1; i <= 8; i++) {
                const activeClass = i === 1 ? ' class="active-page"' : '';
                imagesHTML += `<img src="${zine.pdfFolder}/${zine.id} zine-${i}.png" alt="Page ${i}"${activeClass}>\n            `;
            }
            
            return `
                <div id="${zine.id}-pages" class="page-gallery">
                    <button class="page-gallery-close" onclick="closeGallery('${zine.id}-pages')">‚úï</button>
                    ${imagesHTML}
                    <div class="page-nav">
                        <button class="page-nav-btn" onclick="navigatePage('${zine.id}-pages', -1)">‚Üê <span class="prev-btn-text">Anterior</span></button>
                        <span class="page-counter" id="${zine.id}-counter">1 / 8</span>
                        <button class="page-nav-btn" onclick="navigatePage('${zine.id}-pages', 1)"><span class="next-btn-text">Siguiente</span> ‚Üí</button>
                    </div>
                </div>
            `;
        }

        function renderAllZines() {
            const grid = document.getElementById('zines-grid');
            if (!grid) {
                console.error('Zines grid not found!');
                return;
            }
            
            grid.innerHTML = '';
            
            ZINES_DATA.forEach(zine => {
                grid.insertAdjacentHTML('beforeend', renderZineCard(zine));
                grid.insertAdjacentHTML('beforeend', renderGallery(zine));
            });
        }

        function togglePages(galleryId) {
            const gallery = document.getElementById(galleryId);
            if (gallery) {
                gallery.classList.toggle('active');
            }
        }

        function closeGallery(galleryId) {
            const gallery = document.getElementById(galleryId);
            if (gallery) {
                gallery.classList.remove('active');
            }
        }

        function navigatePage(galleryId, direction) {
            const gallery = document.getElementById(galleryId);
            if (!gallery) return;
            
            const images = gallery.querySelectorAll('img');
            let currentIndex = Array.from(images).findIndex(img => img.classList.contains('active-page'));
            
            images[currentIndex].classList.remove('active-page');
            currentIndex = (currentIndex + direction + images.length) % images.length;
            images[currentIndex].classList.add('active-page');
            
            const counter = gallery.querySelector('.page-counter');
            if (counter) {
                counter.textContent = `${currentIndex + 1} / ${images.length}`;
            }
        }

        const translations = {
            es: {
                headerSubtitle: 'Folletos de instrucciones imprimibles para aficionados a la relojer√≠a',
                introText1: 'Descarga zines listos para imprimir de tus relojes favoritos de la comunidad "Hablemos de Relojes".',
                introText2: 'Cada zine est√° dise√±ado para plegarse en un folleto compacto que encaja perfectamente en tu estuche de reloj.',
                downloadBtn: 'üì• Descargar',
                unfoldBtn: 'üìñ Ver p√°ginas',
                foldBtn: 'üìï Ocultar p√°ginas',
                prevBtn: 'Anterior',
                nextBtn: 'Siguiente',
                footerAbout: 'Sobre este proyecto',
                footerText1: 'Los zines se generan con Typst usando la plantilla zen-zine.',
                footerText2: 'Proyecto comunitario de Hablemos de Relojes.',
                footerGithub: 'GitHub',
                footerDocs: 'Documentaci√≥n'
            },
            de: {
                headerSubtitle: 'Druckbare Anleitungshefte f√ºr Uhrenliebhaber',
                introText1: 'Laden Sie druckfertige Zines Ihrer Lieblingsuhren aus der "Hablemos de Relojes"-Community herunter.',
                introText2: 'Jedes Zine ist so gestaltet, dass es sich zu einer kompakten Brosch√ºre falten l√§sst, die perfekt in Ihr Uhrenetui passt.',
                downloadBtn: 'üì• Herunterladen',
                unfoldBtn: 'üìñ Seiten ansehen',
                foldBtn: 'üìï Seiten ausblenden',
                prevBtn: 'Zur√ºck',
                nextBtn: 'Weiter',
                footerAbout: '√úber dieses Projekt',
                footerText1: 'Die Zines werden mit Typst mit dem zen-zine Template generiert.',
                footerText2: 'Gemeinschaftsprojekt von Hablemos de Relojes.',
                footerGithub: 'GitHub',
                footerDocs: 'Dokumentation'
            },
            en: {
                headerSubtitle: 'Printable instruction booklets for watch enthusiasts',
                introText1: 'Download print-ready zines of your favorite watches from the "Hablemos de Relojes" community.',
                introText2: 'Each zine is designed to fold into a compact booklet that fits perfectly in your watch case.',
                downloadBtn: 'üì• Download',
                unfoldBtn: 'üìñ View pages',
                foldBtn: 'üìï Hide pages',
                prevBtn: 'Previous',
                nextBtn: 'Next',
                footerAbout: 'About this project',
                footerText1: 'Zines are generated with Typst using the zen-zine template.',
                footerText2: 'Community project by Hablemos de Relojes.',
                footerGithub: 'GitHub',
                footerDocs: 'Documentation'
            }
        };

        function setLanguage(lang) {
            currentLanguage = lang;
            const t = translations[lang];
            
            // Update language buttons
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event?.target?.classList.add('active') || document.querySelector(`.lang-btn[onclick*="${lang}"]`)?.classList.add('active');
            
            // Update static text
            document.getElementById('header-subtitle').textContent = t.headerSubtitle;
            document.getElementById('intro-text-1').textContent = t.introText1;
            document.getElementById('intro-text-2').textContent = t.introText2;
            document.getElementById('footer-about').innerHTML = '<strong>' + t.footerAbout + '</strong>';
            document.getElementById('footer-text-1').innerHTML = t.footerText1.replace('Typst', '<a href="https://github.com/typst/typst">Typst</a>').replace('zen-zine', '<em>zen-zine</em>');
            document.getElementById('footer-text-2').innerHTML = t.footerText2.replace('Hablemos de Relojes', '<a href="https://www.hablemosderelojes.com">Hablemos de Relojes</a>');
            document.getElementById('footer-github').textContent = t.footerGithub;
            document.getElementById('footer-docs').textContent = t.footerDocs;
            
            // Update all download buttons
            document.querySelectorAll('.download-btn-text').forEach(btn => {
                btn.textContent = t.downloadBtn;
            });
            
            // Update all unfold/fold buttons
            document.querySelectorAll('.unfold-btn-text').forEach(btn => {
                const gallery = document.getElementById(btn.closest('button').getAttribute('onclick').match(/'([^']+)'/)[1]);
                btn.textContent = gallery && gallery.classList.contains('active') ? t.foldBtn : t.unfoldBtn;
            });
            
            // Update all prev/next buttons
            document.querySelectorAll('.prev-btn-text').forEach(btn => btn.textContent = t.prevBtn);
            document.querySelectorAll('.next-btn-text').forEach(btn => btn.textContent = t.nextBtn);
            
            // Update all zine descriptions
            ZINES_DATA.forEach(zine => {
                const descElem = document.querySelector(`.zine-description[data-id="${zine.id}"]`);
                if (descElem) {
                    const descriptionKey = `description_${lang}`;
                    descElem.textContent = zine[descriptionKey] || zine.description_es || '';
                }
            });
            
            // Update HTML lang attribute
            document.documentElement.lang = lang;
            
            // Save preference
            localStorage.setItem('preferredLanguage', lang);
        }

        // Load data on page load
        document.addEventListener('DOMContentLoaded', loadZinesData);
    </script>
</body>
</html>
